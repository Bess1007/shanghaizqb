<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=11"/>
    <title>新增工作日程</title>
    <!--框架必需start-->
    <link href="../../libs/css/import_main.css" rel="stylesheet" type="text/css"/>
    <link href="../../libs/skins/skyblue/style.css" rel="stylesheet" type="text/css" id="theme" themeColor="skyblue" positionTarget="positionContent"/>
    <link href="skin/style.css" rel="stylesheet" type="text/css" id="skin" skinPath="system/style1_accordion_skyblue/skin/" scrollerX="true"/>
    <link href="../../libs/css/import_basic.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="../../libs/js/jquery.js"></script>
    <script type="text/javascript" src="../../libs/js/language/cn.js"></script>
    <script type="text/javascript" src="../../libs/js/framework.js"></script>
    <!--框架必需end-->
    <!-- 日期选择框start -->
    <script type="text/javascript" src="../../libs/js/form/datePicker/WdatePicker.js"></script>
    <!-- 日期选择框end -->
    <!--引入提示下拉框脚本-->
    <script type='text/javascript' src='../../libs/js/form/suggestion.js'></script>

    <script type="text/javascript" src="js/shzqbqui.js"></script>

    <link rel="stylesheet" href="css/layer.css">
    <script type="text/javascript" src="layer/layer.js"></script>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/shzqb.css">

    <style>
        /******12-26互动改*******/
        .mystylebox {
            position: relative;
        }
        .interactionTableBox {
            padding:15px;
            padding-top: 0;
            display:table;
            width: 100% ;
            height: 100%;
        }
        .ita_leftnav,.ita_rightcon {
            float: none;
            display:table-cell;
            width: auto;
            height:100%;
            vertical-align: top;
        }
        .ita_leftnav {
            width: 135px;
        }

        .sendMsTableBox {
            display:table;
            width: 100%;
        }
        .sendMsTbCell {
            display:table-cell;
            vertical-align: top;
        }
        .sendmes {
            width:98%;
        }
        .ita_hideli .selectbox {
            width:100%!important;
        }
        .right-sendMsTbCell {
            width: 220px;
            height: 100%;
            background-color: #f0f0f0;
        }
        .textalign_right {
            width:100px;
        }

        /*接收人*/
        .sctRecipient-tit {
            border-bottom:1px solid #ddd;
            line-height:34px;
            padding-left: 10px;
            font-size: 13px;
            margin-bottom: 10px;
        }
        .recipientBox {
            width: 100%;
            padding: 5px 10px;
            border:1px solid #D8E3EF;
            min-height: 30px;
            border-radius:3px;
            margin-bottom: 10px;

        }
        .sctRecipient {
            width: 152px;
        }
        .sctRecipientInpBox {
            margin-left: 10px;
            margin-bottom: 10px;
        }
        .suggestion_input {
            width: 152px;
        }
        .selectRecipientBtn {
            margin-right: 0;
            padding:0 10px;
        }
        .allContacts {
            height: 400px;
            overflow: auto;
        }
        .allContactsTit {
            padding-left: 10px;
            line-height: 30px;
            background-color: #e6e6e6;
            font-size: 12px;
        }
        .contactsPart {
            position: relative;
            font-size: 12px;
        }
        .contactsPart .DropdownContorlBtn {
            position: absolute;
            line-height: 30px;
            width: 30px;
            text-align: center;
            top: 0;
            left: 0;
            font-size: 14px;
            cursor: pointer;
        }
        .contactsPart-tit {
            padding-left: 30px;
            line-height: 30px;
            font-weight:bold;
        }
        .contactsPart-people {
            width: 100%;
            padding-left: 30px;
            line-height: 26px;
            cursor: pointer;
        }
        .contactsPart-people:hover {
            background-color: #8cb7e6;
        }
        .contactsPart-people-box {/*分组联系人默认收起*/
            display:none;
        }

        /*选择的联系人*/
        .recipient-cell {
            display:inline-block;
            word-break: keep-all;
            cursor: default;
            font-size: 12px;
            line-height: 20px;
            margin:3px 5px;

            moz-user-select: -moz-none;
            -moz-user-select: none;
            -o-user-select:none;
            -khtml-user-select:none;
            -webkit-user-select:none;
            -ms-user-select:none;
            user-select:none;
        }
        .recipient-cell:hover {
            background-color: #d6e4f2;
        }
        .recipient-cell.actived {
            background-color: #b3d0ef;
        }
        .ita_rightconul,.ita_hideli,.sendMsTableBox,.right-sendMsTbCell {
            height:100%;
        }
        /******12-26互动改end*******/

        /*1-10新增工作日程*/
        tr.agendaTheme td {
            padding-top: 15px;
        }
        .longInp input {
            width: 100%;
        }
        .newAgendaBox td {
            padding:5px 0;
        }
        .sendMsTbCell {
            background-color: #fff;
        }
        .right-sendMsTbCell {
            background-color: #f0f0f0;
        }
        .recipientBox {
            margin-bottom: 0;
        }
        #inputPartake {
            cursor: pointer;
            color: #dc7c00;
            font-size: 12px;
            margin-right: 4px;
        }
        #inputPartake:hover {
            color: #dc6200;
        }
        /*1-10新增工作日程end*/
    </style>
</head>
<body class="bclightblue padding10">
<div class="page_content mystylebox">
    <div class=" forwardBox newAgendaBox">
        <div class="sendMsTableBox">
            <div class="sendMsTbCell">
                <table class="sendmes">
                    <tbody>
                    <tr class="agendaTheme longInp">
                        <td class="textalign_right">主题：</td>
                        <td><input type="text"></td>
                    </tr>
                    <tr>
                        <td class="textalign_right">时间范围：</td>
                        <td>
                            <input type="text" id="beginTime" class="dateIcon" />
                            <input type="text" id="endTime" class="dateIcon" />
                        </td>
                    </tr>
                    <tr class="longInp">
                        <td class="textalign_right">状态：</td>
                        <td><input type="text"></td>
                    </tr>
                    <tr class="longInp">
                        <td class="textalign_right">公司：</td>
                        <td><input type="text"></td>
                    </tr>
                    <tr class="receivep">
                        <td class="textalign_right">参与人员：</td>
                        <td class="clearfix">
                            <div class="recipientBox"><!--选择的联系人--结果-->
                                <span class="recipient-cell"><i class="recipient-cell-name">测试名称</i><i class="recipient-cell-separate">；</i></span>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td class="textalign_right">会访记录：</td>
                        <td>
                            <textarea name="" id="" cols="30" rows="10" style="width: 100%;height: 200px;"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td class="textalign_right">备注：</td>
                        <td>
                            <textarea name="" id="" cols="30" rows="10" style="width: 100%;height: 200px;"></textarea>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="sendMsTbCell right-sendMsTbCell"><!--所有联系人-->
                <div class="sctRecipient-tit">
                    <span>通讯录</span>
                    <span class="fr" id="inputPartake">录入参与人员</span>
                </div>
                <div class="sctRecipientInpBox"><!--联系人模糊查询-->
                    <div class="suggestion sctRecipient" id="suggestion2"></div>
                    <input type="button" onclick="selectRecipient()" value="确定" class="selectRecipientBtn ">
                </div>
                <!--所有联系人-->
                <div class="allContacts">
                    <div class="allContactsTit">
                        <span>所有联系人</span>
                    </div>
                    <!--分组1-->
                    <div class="contactsPart">
                        <!--分组名称-->
                        <div class="contactsPart-tit">
                            <span class="contactsPart-name">分组1</span>
                        </div>
                        <span class="DropdownContorlBtn fa fa-plus-square-o" onclick="drawerFun(this)"></span><!--控制展开收缩按钮-->
                        <!--分组联系人-->
                        <ul class="contactsPart-people-box">
                            <li class="contactsPart-people">张三</li>
                            <li class="contactsPart-people">李四</li>
                            <li class="contactsPart-people">王五</li>
                        </ul>

                    </div>
                    <!--分组1 end-->
                    <!--分组2-->
                    <div class="contactsPart">
                        <!--分组名称-->
                        <div class="contactsPart-tit">
                            <span class="contactsPart-name">分组2</span>
                        </div>
                        <span class="DropdownContorlBtn fa fa-plus-square-o" onclick="drawerFun(this)"></span><!--控制展开收缩按钮-->
                        <!--分组联系人-->
                        <ul class="contactsPart-people-box">
                            <li class="contactsPart-people">张三2</li>
                            <li class="contactsPart-people">李四2</li>
                            <li class="contactsPart-people">王五2</li>
                        </ul>
                    </div>
                    <!--分组2 end-->
                </div>
                <!--所有联系人end-->
            </div>
        </div>
    </div>
</div>

<!--12-26选择接收人-->
<!--自动提示框-->
<script>
    function initComplete(){
        /*初始化自动提示框*/
        $("#suggestion2").data("data",listdata);
        $("#suggestion2").render();
        /*初始化自动提示框end*/
        //获取当前主题风格，用于设置日期控件的皮肤
        try {
            dateSkin = themeColor;
        } catch(e) {}

        //自定义点击触发日期控件
        document.getElementById('beginTime').onfocus = function() {
            var endtimeTf = $dp.$('endTime');
            WdatePicker({
                skin: dateSkin,
                onpicked: function() {
                    endtimeTf.focus();
                },
                maxDate: '#F{$dp.$D(\'endTime\')}'
            });
        };
        document.getElementById('endTime').onfocus = function() {
            //这里设置了最大日期为当前日期，如果不需要则把maxDate:'%y-%M-%d'去掉
            WdatePicker({
                skin: dateSkin,
                minDate: '#F{$dp.$D(\'beginTime\')}'
            });
        }

        //平面显示
        WdatePicker({
            skin: dateSkin,
            eCont: 'div1',
            onpicked: function(dp) {
                top.Toast("showNoticeToast", '你选择的日期是:' + dp.cal.getDateStr())
            }
        })

        document.getElementById('date-11').onfocus = function() {
            WdatePicker({
                skin: dateSkin,
                maxDate: '%y-%M-%d'
            });
        }

    }

    /*设置本地联系人数据*/
    var listdata={"list":[
        {value:"1",key:"北京",suggest:"北京|beijing|bj"},
        {value:"2",key:"广州",suggest:"广州|guangzhou|gz"},
        {value:"3",key:"深圳",suggest:"深圳|shenzhen|sz"},
        {value:"4",key:"上海",suggest:"上海|shanghai|sh"},
        {value:"5",key:"长沙",suggest:"长沙|changsha|cs"},
        {value:"6",key:"成都",suggest:"成都|chengdu|cd"},
        {value:"7",key:"贵阳",suggest:"贵阳|guiyang|gy"},
        {value:"8",key:"海口",suggest:"海口|haikou|hk"},
        {value:"9",key:"杭州",suggest:"杭州|hangzhou|hz"},
        {value:"10",key:"昆明",suggest:"昆明|kunming|km"},
        {value:"11",key:"南昌",suggest:"南昌|nanchang|nc"},
        {value:"12",key:"南京",suggest:"南京|nanjing|nj"},
        {value:"13",key:"三亚",suggest:"三亚|sanya|sy"},
        {value:"14",key:"沈阳",suggest:"沈阳|shenyang|sy"},
        {value:"15",key:"温州",suggest:"温州|wenzhou|wz"},
        {value:"16",key:"武汉",suggest:"武汉|wuhan|wh"},
        {value:"17",key:"厦门",suggest:"厦门|xiamen|xm"},
        {value:"18",key:"西安",suggest:"西安|xian|xa"},
        {value:"19",key:"郑州",suggest:"郑州|zhenghou|zz"},
        {value:"20",key:"汕头",suggest:"汕头|shantou|st"},
        {value:"21",key:"太原",suggest:"太原|taiyuan|ty"},
        {value:"22",key:"天津",suggest:"天津|tianjin|tj"}]};
    /*设置本地联系人数据end*/
    function addName(name){
        /*将选中的名称append 到 recipientBox 里*/
        var recipientLength = $('.recipientBox .recipient-cell').length;/*获取 recipientBox 里 recipient-cell 元素个数*/
        var j = 0;
        console.log(recipientLength);
        for(var i=0;i<recipientLength;i++){
            if($('.recipientBox .recipient-cell').eq(i).attr('title') == name){
                j++;
            }
        }
        if(j==0&&name!='') {
            var recipientCell = '<span class="recipient-cell" title="'+name+'"><i class="recipient-cell-name">' + name + '</i><i class="recipient-cell-separate">；</i></span>'
            $('.recipientBox').append(recipientCell);
        }
    }
    function selectRecipient() { /*点击自动提示框确定按钮*/

        var relText = $("#suggestion2").attr("relText");/*获取选中文本*/
        var relValue = $("#suggestion2").attr("relValue");/*获取选中值*/

        console.log(relText + relValue);
        addName(relText)
    }

    /*联系人分组展开收缩*/
    function drawerFun(obj){
        /*console.log($(this).siblings('ul'));*/
        if($(obj).hasClass('fa-plus-square-o')){
            $(obj).removeClass('fa-plus-square-o').addClass('fa-minus-square-o')
        }else{
            $(obj).removeClass('fa-minus-square-o').addClass('fa-plus-square-o')
        }
        $(obj).siblings('.contactsPart-people-box').toggle(200)
    }
    /*联系人分组展开收缩end*/

    /*选择右侧全部联系人里面的联系人*/
    $('body').on('click','.contactsPart-people',function () {
        /*获取联系人名称*/
        var ContactsName = $(this).text();
        addName(ContactsName)

    })
    /*选择右侧全部联系人里面的联系人end*/

    /*删除联系人*/
    $('body').on('click','.recipient-cell',function () {
        $(this).toggleClass('actived');/*选中联系人*/
    })
    //点击删除键跟退格键，删除对应的收件人
    $(document).bind('keydown',
        function(event) {
            if(46==event.keyCode ){ //Delete键   
                $("body .recipient-cell.actived").remove();
            }else if(8==event.keyCode){//退格键
                $("body .recipient-cell.actived").remove();
            }
        }
    );

    /*设置 forwardBox 高度*/
    $(window).resize(function () {
        $('.forwardBox').css('height',''+window.screen.height-236);
    });
    $('.forwardBox').css('height',''+window.screen.height-236);

    /********1-10新增录入联系人********/
    $('#inputPartake').click(function () {
        layer.open({
            type:1,
            title:'录入参与人',
            content:$('.inputPartakeBox'),
            area:['350px','150px'],
            shadeClose: true
        })
    })

    function selectInputP() {
        var inputPartakeTxt = $('.partakeInt').val();
        addName(inputPartakeTxt);/*添加输入的人员名称到$('.recipientBox)里*/

    }
    /********1-10新增录入联系人 end********/
</script>
<!--12-26选择接收人end-->


<div class="inputPartakeBox" style="padding: 20px;display:none">
    <input type="text" style="width: 258px" class="partakeInt">
    <input type="button" onclick="selectInputP()" value="确定" class="selectRecipientBtn  button" style="font-family: 宋体; font-size: 12px;">
</div>
</body>
</html>